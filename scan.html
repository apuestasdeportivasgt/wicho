<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extractor M3U8</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        input[type="text"], textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #333;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .results-section {
            margin-top: 30px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .results-header h2 {
            color: #333;
        }
        
        .count {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .results-list {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .result-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }
        
        .result-url {
            flex: 1;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #495057;
        }
        
        .result-actions {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.85em;
            min-width: auto;
        }
        
        .instructions {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .instructions ol, .instructions ul {
            margin-left: 20px;
            color: #856404;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            position: relative;
        }
        
        .copy-code-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
        }
        
        .copy-code-btn:hover {
            background: #5568d3;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-weight: 600;
        }
        
        .error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            border-radius: 8px;
            color: #721c24;
            margin-top: 15px;
        }
        
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            border-radius: 8px;
            color: #155724;
            margin-top: 15px;
        }
        
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            border-radius: 8px;
            color: #0c5460;
            margin-top: 15px;
        }
        
        .empty {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .highlight {
            background: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé• Extractor de Enlaces M3U8</h1>
            <p>Herramienta para extraer enlaces de streaming de Futbol Libre</p>
        </div>
        
        <div class="content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('method1')">üìã M√©todo 1: Script de Consola</button>
                <button class="tab" onclick="switchTab('method2')">üîç M√©todo 2: An√°lisis de P√°gina</button>
                <button class="tab" onclick="switchTab('method3')">üìù M√©todo 3: Entrada Manual</button>
            </div>
            
            <!-- M√âTODO 1: Script de Consola -->
            <div id="method1" class="tab-content active">
                <div class="instructions">
                    <h3>üéØ M√©todo m√°s efectivo - Script de Consola del Navegador</h3>
                    <p>Este m√©todo captura todos los enlaces m3u8 que se cargan din√°micamente:</p>
                    <ol>
                        <li>Abre la p√°gina del canal en tu navegador (ejemplo: <span class="highlight">futbollibre.mx/embed/eventos.html?r=...</span>)</li>
                        <li>Presiona <strong>F12</strong> o <strong>Ctrl+Shift+I</strong> (Cmd+Option+I en Mac)</li>
                        <li>Ve a la pesta√±a <strong>Console (Consola)</strong></li>
                        <li>Copia y pega el script de abajo</li>
                        <li>Presiona <strong>Enter</strong></li>
                        <li>Los enlaces m3u8 se mostrar√°n en la consola y se copiar√°n autom√°ticamente</li>
                    </ol>
                </div>
                
                <div class="code-block">
                    <button class="copy-code-btn" onclick="copyScript()">üìã Copiar Script</button>
                    <pre id="consoleScript">(function() {
    console.clear();
    console.log('%cüé• Buscando enlaces M3U8...', 'color: #667eea; font-size: 16px; font-weight: bold;');
    
    const links = new Set();
    
    // M√©todo 1: Buscar en todos los elementos de la p√°gina
    document.querySelectorAll('*').forEach(el => {
        ['src', 'href', 'data-src', 'data-url'].forEach(attr => {
            const val = el.getAttribute(attr);
            if (val && val.includes('.m3u8')) {
                links.add(val);
            }
        });
    });
    
    // M√©todo 2: Buscar en el HTML completo
    const html = document.documentElement.innerHTML;
    const m3u8Pattern = /https?:\/\/[^\s"'<>]+\.m3u8[^\s"'<>]*/gi;
    const matches = html.match(m3u8Pattern);
    if (matches) {
        matches.forEach(link => links.add(link));
    }
    
    // M√©todo 3: Interceptar solicitudes fetch/XHR
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        const url = args[0];
        if (typeof url === 'string' && url.includes('.m3u8')) {
            links.add(url);
            console.log('%c‚úÖ M3U8 detectado via Fetch:', 'color: #28a745; font-weight: bold;', url);
        }
        return originalFetch.apply(this, args);
    };
    
    const originalOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(method, url) {
        if (url.includes('.m3u8')) {
            links.add(url);
            console.log('%c‚úÖ M3U8 detectado via XHR:', 'color: #28a745; font-weight: bold;', url);
        }
        return originalOpen.apply(this, arguments);
    };
    
    // Mostrar resultados
    setTimeout(() => {
        console.log('%c‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'color: #667eea;');
        console.log('%cüìä RESULTADOS:', 'color: #667eea; font-size: 14px; font-weight: bold;');
        console.log('%c‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'color: #667eea;');
        
        if (links.size > 0) {
            console.log(`%c‚úÖ Se encontraron ${links.size} enlace(s) M3U8:`, 'color: #28a745; font-weight: bold;');
            links.forEach((link, index) => {
                console.log(`%c${index + 1}.`, 'color: #667eea; font-weight: bold;', link);
            });
            
            const allLinks = Array.from(links).join('\n');
            navigator.clipboard.writeText(allLinks).then(() => {
                console.log('%cüìã Enlaces copiados al portapapeles!', 'color: #28a745; font-weight: bold; font-size: 14px;');
            });
        } else {
            console.log('%c‚ö†Ô∏è No se encontraron enlaces M3U8 todav√≠a.', 'color: #ffc107; font-weight: bold;');
            console.log('%cüí° Reproduce el video y espera unos segundos...', 'color: #17a2b8;');
        }
        
        console.log('%c‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ', 'color: #667eea;');
        console.log('%cüîÑ El script seguir√° monitoreando nuevas peticiones M3U8', 'color: #6c757d;');
    }, 2000);
})();</pre>
                </div>
                
                <div class="info">
                    <strong>üí° Consejo:</strong> Si no aparecen enlaces inmediatamente, reproduce el video y el script los capturar√° autom√°ticamente cuando se carguen.
                </div>
            </div>
            
            <!-- M√âTODO 2: An√°lisis de P√°gina -->
            <div id="method2" class="tab-content">
                <div class="instructions">
                    <h3>üîç An√°lisis Directo de P√°gina</h3>
                    <p>Intenta extraer enlaces directamente desde una URL (limitado por CORS):</p>
                </div>
                
                <div class="input-section">
                    <div class="input-group">
                        <label for="urlInput">üîó URL de la p√°gina embed:</label>
                        <input 
                            type="text" 
                            id="urlInput" 
                            placeholder="https://futbollibre.mx/embed/eventos.html?r=..."
                            value="">
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-primary" onclick="analyzeDirectly()">üîç Analizar P√°gina</button>
                        <button class="btn-secondary" onclick="clearResults()">üóëÔ∏è Limpiar</button>
                    </div>
                </div>
                
                <div id="statusMessage2"></div>
                
                <div class="results-section" id="resultsSection2" style="display:none;">
                    <div class="results-header">
                        <h2>Resultados encontrados:</h2>
                        <span class="count" id="resultCount2">0 enlaces</span>
                    </div>
                    <div class="results-list" id="resultsList2"></div>
                    <button class="btn-success" onclick="downloadAll()" style="margin-top: 15px;">‚¨áÔ∏è Descargar Todos</button>
                </div>
            </div>
            
            <!-- M√âTODO 3: Entrada Manual -->
            <div id="method3" class="tab-content">
                <div class="instructions">
                    <h3>üìù Entrada Manual de Enlaces</h3>
                    <p>Si ya tienes enlaces m3u8, p√©galos aqu√≠ para organizarlos:</p>
                </div>
                
                <div class="input-section">
                    <div class="input-group">
                        <label for="manualInput">üìã Pega tus enlaces (uno por l√≠nea):</label>
                        <textarea 
                            id="manualInput" 
                            placeholder="https://rm8zcvk3.fubohd.com/beinsportes/mono.m3u8?token=...
https://otro-enlace.com/stream.m3u8
..."></textarea>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn-primary" onclick="processManualLinks()">‚úÖ Procesar Enlaces</button>
                        <button class="btn-secondary" onclick="clearManual()">üóëÔ∏è Limpiar</button>
                    </div>
                </div>
                
                <div id="statusMessage3"></div>
                
                <div class="results-section" id="resultsSection3" style="display:none;">
                    <div class="results-header">
                        <h2>Enlaces procesados:</h2>
                        <span class="count" id="resultCount3">0 enlaces</span>
                    </div>
                    <div class="results-list" id="resultsList3"></div>
                    <button class="btn-success" onclick="downloadManual()" style="margin-top: 15px;">‚¨áÔ∏è Descargar Todos</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let foundLinks = [];
        let manualLinks = [];
        let currentTab = 'method1';

        function switchTab(tabName) {
            currentTab = tabName;
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function copyScript() {
            const script = document.getElementById('consoleScript').textContent;
            navigator.clipboard.writeText(script).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Copiado!';
                btn.style.background = '#28a745';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#667eea';
                }, 2000);
            });
        }

        async function analyzeDirectly() {
            const url = document.getElementById('urlInput').value.trim();
            const statusDiv = document.getElementById('statusMessage2');
            
            if (!url) {
                statusDiv.innerHTML = '<div class="error">‚ö†Ô∏è Por favor ingresa una URL v√°lida</div>';
                return;
            }
            
            statusDiv.innerHTML = '<div class="loading">üîÑ Analizando p√°gina...</div>';
            foundLinks = [];
            
            try {
                const response = await fetch(url);
                const html = await response.text();
                
                const m3u8Patterns = [
                    /https?:\/\/[^\s"'<>)]+\.m3u8[^\s"'<>)]*/gi,
                    /"(https?:\/\/[^"]+\.m3u8[^"]*)"/gi,
                    /'(https?:\/\/[^']+\.m3u8[^']*)'/gi,
                    /src["']?\s*[:=]\s*["']?(https?:\/\/[^"']+\.m3u8[^"']*)/gi,
                    /url["']?\s*[:=]\s*["']?(https?:\/\/[^"']+\.m3u8[^"']*)/gi,
                ];
                
                m3u8Patterns.forEach(pattern => {
                    const matches = html.matchAll(pattern);
                    for (const match of matches) {
                        let link = match[1] || match[0];
                        link = link.replace(/["'\\]/g, '').trim();
                        if (link && link.startsWith('http') && !foundLinks.includes(link)) {
                            foundLinks.push(link);
                        }
                    }
                });
                
                foundLinks = [...new Set(foundLinks)];
                
                if (foundLinks.length > 0) {
                    displayResults(foundLinks, 'resultsSection2', 'resultsList2', 'resultCount2');
                    statusDiv.innerHTML = `<div class="success">‚úÖ Se encontraron ${foundLinks.length} enlace(s) m3u8</div>`;
                } else {
                    statusDiv.innerHTML = '<div class="error">‚ùå No se encontraron enlaces m3u8 en el HTML est√°tico.<br><br>üí° <strong>Recomendaci√≥n:</strong> Usa el <strong>M√©todo 1: Script de Consola</strong> para capturar enlaces que se cargan din√°micamente con JavaScript.</div>';
                    document.getElementById('resultsSection2').style.display = 'none';
                }
                
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">‚ùå No se pudo acceder a la p√°gina debido a restricciones CORS.<br><br>üí° <strong>Soluci√≥n:</strong> Usa el <strong>M√©todo 1: Script de Consola</strong> que funciona directamente en la p√°gina.</div>`;
            }
        }

        function processManualLinks() {
            const input = document.getElementById('manualInput').value.trim();
            const statusDiv = document.getElementById('statusMessage3');
            
            if (!input) {
                statusDiv.innerHTML = '<div class="error">‚ö†Ô∏è Por favor ingresa al menos un enlace</div>';
                return;
            }
            
            const lines = input.split('\n').filter(line => line.trim());
            manualLinks = [];
            
            lines.forEach(line => {
                line = line.trim();
                if (line.includes('.m3u8') && line.startsWith('http')) {
                    manualLinks.push(line);
                }
            });
            
            if (manualLinks.length > 0) {
                displayResults(manualLinks, 'resultsSection3', 'resultsList3', 'resultCount3');
                statusDiv.innerHTML = `<div class="success">‚úÖ Se procesaron ${manualLinks.length} enlace(s) v√°lidos</div>`;
            } else {
                statusDiv.innerHTML = '<div class="error">‚ùå No se encontraron enlaces m3u8 v√°lidos en el texto ingresado</div>';
            }
        }

        function displayResults(links, sectionId, listId, countId) {
            const resultsSection = document.getElementById(sectionId);
            const resultsList = document.getElementById(listId);
            const resultCount = document.getElementById(countId);
            
            resultsSection.style.display = 'block';
            resultCount.textContent = `${links.length} enlace${links.length !== 1 ? 's' : ''}`;
            
            resultsList.innerHTML = links.map((link, index) => `
                <div class="result-item">
                    <div class="result-url">${link}</div>
                    <div class="result-actions">
                        <button class="btn-primary btn-small" onclick="copyLink('${link.replace(/'/g, "\\'")}')">üìã Copiar</button>
                        <button class="btn-success btn-small" onclick="testLink('${link.replace(/'/g, "\\'")}')">‚ñ∂Ô∏è Abrir</button>
                    </div>
                </div>
            `).join('');
        }

        function copyLink(link) {
            navigator.clipboard.writeText(link).then(() => {
                alert('‚úÖ Enlace copiado al portapapeles');
            });
        }

        function testLink(link) {
            window.open(link, '_blank');
        }

        function downloadAll() {
            const text = foundLinks.join('\n');
            downloadFile(text, 'enlaces_m3u8.txt');
        }

        function downloadManual() {
            const text = manualLinks.join('\n');
            downloadFile(text, 'enlaces_m3u8.txt');
        }

        function downloadFile(text, filename) {
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
            alert('‚úÖ Archivo descargado');
        }

        function clearResults() {
            foundLinks = [];
            document.getElementById('urlInput').value = '';
            document.getElementById('resultsList2').innerHTML = '';
            document.getElementById('resultsSection2').style.display = 'none';
            document.getElementById('statusMessage2').innerHTML = '';
        }

        function clearManual() {
            manualLinks = [];
            document.getElementById('manualInput').value = '';
            document.getElementById('resultsList3').innerHTML = '';
            document.getElementById('resultsSection3').style.display = 'none';
            document.getElementById('statusMessage3').innerHTML = '';
        }
    </script>
</body>
</html>
